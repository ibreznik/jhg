(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,a){e.exports=a.p+"static/media/play.0c1ce2dd.svg"},15:function(e,t,a){e.exports=a.p+"static/media/check_blank.5e8e3bc4.svg"},16:function(e,t,a){e.exports=a.p+"static/media/check_full.07199ac9.svg"},18:function(e,t,a){e.exports=a.p+"static/media/pause.586f15b3.svg"},27:function(e,t,a){e.exports=a.p+"static/media/error.35a6ccb5.svg"},28:function(e,t,a){e.exports=a.p+"static/media/plus.4b3f33aa.svg"},30:function(e,t,a){e.exports=a(66)},36:function(e,t,a){},63:function(e,t,a){},66:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(14),i=a.n(r),o=(a(36),a(4)),c=a(5),l=a(7),u=a(6),d=a(8),h=a(68),m=a(69),p=a(1),g=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleChange=a.handleChange.bind(Object(p.a)(Object(p.a)(a))),a.keypress=a.keypress.bind(Object(p.a)(Object(p.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleChange",value:function(e){this.props.onChange(e.target.value)}},{key:"keypress",value:function(e){"Enter"===e.key&&(console.log("Enter pressed"),this.props.done())}},{key:"render",value:function(){var e=this.props.text;return s.a.createElement("input",{ref:"mainInput",className:"inputTask",type:"text",onChange:this.handleChange,value:e,onKeyPress:this.keypress})}}]),t}(n.Component),k=a(12),f=a.n(k),b=a(15),v=a.n(b),j=a(16),C=a.n(j),O=a(18),E=a.n(O),w=a(27),y=a.n(w),S=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.started,t=this.props.done;if(this.props.edit)return s.a.createElement("div",{className:"oneTask"},s.a.createElement("img",{className:"leftButton",src:y.a,alt:"Delete",onClick:this.props.onDelete}),t?s.a.createElement("span",{onClick:this.props.taskSelected},s.a.createElement("s",null," ",this.props.name," ")):s.a.createElement("span",{onClick:this.props.taskSelected},this.props.name),s.a.createElement("img",{className:"rightButton",src:t?C.a:v.a,alt:t?"Mark not done":"Mark done",onClick:this.props.onComplete}));for(var a=!1,n=!1,r=this.props.tags,i=r.length,o=0;o<i;o++){var c=r[o];"shallow"===c.name&&(a=!0),"deep"===c.name&&(n=!0)}return n?s.a.createElement("div",{className:"oneTask"},s.a.createElement("img",{className:"leftButton",src:e?E.a:f.a,alt:e?"Pause":"Start",onClick:this.props.onStart}),t?s.a.createElement("span",{onClick:this.props.taskSelected},s.a.createElement("s",null,s.a.createElement("b",null," ",this.props.name," "))):s.a.createElement("span",{onClick:this.props.taskSelected},s.a.createElement("b",null,this.props.name)),s.a.createElement("img",{className:"rightButton",src:t?C.a:v.a,alt:t?"Mark not done":"Mark done",onClick:this.props.onComplete})):a?s.a.createElement("div",{className:"oneTask"},s.a.createElement("img",{className:"leftButton",src:e?E.a:f.a,alt:e?"Pause":"Start",onClick:this.props.onStart}),t?s.a.createElement("span",{onClick:this.props.taskSelected},s.a.createElement("s",null,s.a.createElement("i",null," ",this.props.name," "))):s.a.createElement("span",{onClick:this.props.taskSelected},s.a.createElement("i",null,this.props.name)),s.a.createElement("img",{className:"rightButton",src:t?C.a:v.a,alt:t?"Mark not done":"Mark done",onClick:this.props.onComplete})):s.a.createElement("div",{className:"oneTask"},s.a.createElement("img",{className:"leftButton",src:e?E.a:f.a,alt:e?"Pause":"Start",onClick:this.props.onStart}),t?s.a.createElement("span",{onClick:this.props.taskSelected},s.a.createElement("s",null," ",this.props.name," ")):s.a.createElement("span",{onClick:this.props.taskSelected},this.props.name),s.a.createElement("img",{className:"rightButton",src:t?C.a:v.a,alt:t?"Mark not done":"Mark done",onClick:this.props.onComplete}))}}]),t}(n.Component),T=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"oneTask"},s.a.createElement("span",{onClick:this.props.onClick},this.props.name))}}]),t}(n.Component),x=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"oneTask"},s.a.createElement("span",{onClick:this.props.onClick},this.props.name))}}]),t}(n.Component),_=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"addFriend"},s.a.createElement("span",{onClick:this.props.onDone},"Not Ready"))}}]),t}(n.Component),N=a(19),D=a(13),M=a.n(D),A=a(28),B=a.n(A),W=Object(N.SortableElement)(function(e){var t=e.value;return s.a.createElement("li",null,t)}),P=Object(N.SortableContainer)(function(e){var t=e.items;return s.a.createElement("ul",null,t.map(function(e,t){return s.a.createElement(W,{key:"item-".concat(t),index:t,value:e})}))}),F=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).onSortEnd=function(e){var t=e.oldIndex,n=e.newIndex;a.setState({tasks:Object(N.arrayMove)(a.state.tasks,t,n)},function(){a.reorder()})},a.state={showing:"tasks",current_tag:"",possible_tags:[],guesses:[],editing:"",edit:!1,tasks:[],friends:[],latest_type:"tag",new_task:{name:"",started:!1,times:[],done:[],tags:[{name:"",order:0}],aim_date:"",due_date:"",raw:"",users:[]},text:"",user:{name:"Ilya",id:"0"}},a.getTasks=a.getTasks.bind(Object(p.a)(Object(p.a)(a))),a.getTags=a.getTags.bind(Object(p.a)(Object(p.a)(a))),a.processText=a.processText.bind(Object(p.a)(Object(p.a)(a))),a.commitAndClear=a.commitAndClear.bind(Object(p.a)(Object(p.a)(a))),a.commitTask=a.commitTask.bind(Object(p.a)(Object(p.a)(a))),a.textChanged=a.textChanged.bind(Object(p.a)(Object(p.a)(a))),a.complete=a.complete.bind(Object(p.a)(Object(p.a)(a))),a.start=a.start.bind(Object(p.a)(Object(p.a)(a))),a.delete_task=a.delete_task.bind(Object(p.a)(Object(p.a)(a))),a.onSortEnd=a.onSortEnd.bind(Object(p.a)(Object(p.a)(a))),a.addTask=a.addTask.bind(Object(p.a)(Object(p.a)(a))),a.show=a.show.bind(Object(p.a)(Object(p.a)(a))),a.sync=a.sync.bind(Object(p.a)(Object(p.a)(a))),a.reorder=a.reorder.bind(Object(p.a)(Object(p.a)(a))),a.componentDidMount=a.componentDidMount.bind(Object(p.a)(Object(p.a)(a))),a.taskSelected=a.taskSelected.bind(Object(p.a)(Object(p.a)(a))),console.log(a.tomorrow()),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"show",value:function(e){this.setState({showing:e})}},{key:"componentDidMount",value:function(){this.getTasks(),this.getTags()}},{key:"sync",value:function(){this.reorder(),this.getTasks(),this.getTags()}},{key:"getTasks",value:function(){var e=this,t=this.state.current_tag;M.a.get("https://api.ibreznik.com/now",{params:{tag:t}}).then(function(e){return e.data}).then(function(a){a.sort(function(e,a){return e.tags.find(function(e){return e.name===t}).order-a.tags.find(function(e){return e.name===t}).order}).reverse(),e.setState({tasks:a})})}},{key:"componentWillUnmount",value:function(){this.reorder()}},{key:"reorder",value:function(){for(var e=this,t=this.state.tasks.slice(),a=t.length,n=0;n<a;n++)t[n].tags.find(function(t){return t.name===e.state.current_tag}).order=a-n,this.update(t[n])}},{key:"update",value:function(e){M.a.put("https://api.ibreznik.com/task",e)}},{key:"getTags",value:function(){var e=this;M.a.get("https://api.ibreznik.com/tags").then(function(t){return e.setState({possible_tags:t.data})})}},{key:"addFriend",value:function(e){}},{key:"twoDigit",value:function(e){return(e<10?"0":"")+e}},{key:"today",value:function(){var e=new Date;return""+e.getFullYear()+this.twoDigit(e.getMonth()+1)+this.twoDigit(e.getDate())}},{key:"tomorrow",value:function(){var e=new Date,t=new Date;return t.setDate(e.getDate()+1),""+t.getFullYear()+this.twoDigit(t.getMonth()+1)+this.twoDigit(t.getDate())}},{key:"processText",value:function(){for(var e=this.state.text,t=e.split(" ").filter(function(e){return e.startsWith("#")}),a=[],n=0;n<t.length;n++)e=e.replace(t[n],""),t[n]=t[n].replace("#","").toLowerCase(),"today"===t[n]?t[n]=this.today():"tomorrow"===t[n]&&(t[n]=this.tomorrow()),a.push({name:t[n],order:0});a.push({name:"",order:0}),console.log(a),e=e.trim();var s=this.state.text;this.setState({text:e});var r=e.split(" ").filter(function(e){return e.startsWith("~")});if(r.length>0){e=e.replace(r[0],"");var i=r[0].substring(1).split("-");if(2===i.length)return{text:e,tags:a,raw:s,est_low:i[0],est_high:i[1]};if(1===i.length)return{text:e,tags:a,raw:s,est_low:i[0]}}return{text:e,tags:a,raw:s}}},{key:"commitAndClear",value:function(e){this.commitTask(e),this.setState({text:""})}},{key:"commitTask",value:function(e){var t=this;console.log(e),M.a.post("https://api.ibreznik.com/task",e).then(function(e){var a=t.state.tasks,n=a.findIndex(function(e){return void 0===e._id});a[n]._id={$oid:e.data},t.setState({tasks:a})})}},{key:"addTask",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=e?[(new Date).getTime()]:[],a=this.processText(),n={name:a.text,tags:a.tags,times:t,started:e,done:!1,delays:0,raw:a.raw};"est_high"in a&&(n.est_high=parseFloat(a.est_high)),"est_low"in a&&(n.est_low=parseFloat(a.est_low));var s=this.state.tasks;s.push(n),this.setState({tasks:s}),this.commitAndClear(n)}},{key:"textChanged",value:function(e){this.setState({text:e})}},{key:"createTag",value:function(e){}},{key:"setCurrentPerson",value:function(e){}},{key:"setCurrentTag",value:function(e){var t=this;this.setState({current_tag:e},function(){t.getTasks(),t.setState({showing:"tasks"})}),console.log(this.state.tasks)}},{key:"addTagToCurrent",value:function(e){}},{key:"complete",value:function(e){var t=this,a=this.state.tasks.slice();a[e].done=!a[e].done,a[e].started&&(a[e].started=!a[e].started,a[e].times.push((new Date).getTime())),this.setState({tasks:a}),this.update(a[e]),console.log(a[e]);for(var n=a[e].tags.length,s=0;s<n;s++){"repeat"===a[e].tags[s].name&&this.setState({text:a[e].raw},function(){t.addTask()})}}},{key:"start",value:function(e){var t=this.state.tasks.slice();t[e].started=!t[e].started,t[e].times.push((new Date).getTime()),t[e].done&&(t[e].done=!1),this.setState({tasks:t}),this.update(t[e])}},{key:"delete_task",value:function(e){var t=this,a=this.state.tasks.slice();M.a.delete("https://api.ibreznik.com/task",{params:{id:a[e]._id.$oid}}).then(function(e){return t.sync()})}},{key:"taskSelected",value:function(e){var t=this.state.tasks.slice();this.setState({editing:t[e]._id.$oid},this.setState({text:t[e].raw}))}},{key:"getLatestTag",value:function(){}},{key:"render",value:function(){var e=this,t=this.state.showing,a=this.state.latest_type,n=this.getLatestTag(),r=this.state.edit,i="";"tasks"===t?i=this.state.tasks.map(function(t,a){return s.a.createElement(S,{name:t.name,id:t._id,started:t.started,done:t.done,tags:t.tags,onStart:function(){return e.start(a)},onDelete:function(){return e.delete_task(a)},taskSelected:function(){return e.taskSelected(a)},onComplete:function(){return e.complete(a)},edit:r})}):"guess"===t?i=this.state.possible_tags.map(function(t,a){return s.a.createElement(x,{name:t,onClick:function(){return e.addTagToCurrent(a)}})}):"tags"===t&&(console.log(this.state.possible_tags),"tag"===a?i=this.state.possible_tags.map(function(t,a){return s.a.createElement(x,{name:t,onClick:function(){return e.setCurrentTag(t)}})}):"user"===a&&(i=this.state.friends.map(function(t,a){return s.a.createElement(T,{name:t,onClick:function(){return e.setCurrentPerson(a)}})})));var o="";return"guess"===t?"tag"===a?o=s.a.createElement("div",{className:"createNewTag",onClick:function(){return e.createTag(n)}},'"Create new tag "+tag'):"user"===a&&(o=s.a.createElement(_,{onDone:this.addFriend})):o=s.a.createElement("div",{className:"controls"},s.a.createElement("div",{className:"rightControl",onClick:function(){return e.setState({edit:!e.state.edit})}},"Edit"),s.a.createElement("div",{className:"leftControl",onClick:this.sync},"Sync"),s.a.createElement("center",null,"tasks"===t?s.a.createElement("div",{className:"centerControl",onClick:function(){return e.show("tags")}}," Switch to ..."):s.a.createElement("div",{className:"centerControl",onClick:function(){return e.setCurrentTag("")}}," Show all"))),s.a.createElement("div",{className:"main"},s.a.createElement("div",{className:"top"},s.a.createElement("img",{className:"add",src:B.a,alt:"Add",height:"35",onClick:function(){return e.addTask(!1)}}),s.a.createElement("img",{className:"addAndStart",src:f.a,alt:"Start",height:"35",onClick:function(){return e.addTask(!0)}}),s.a.createElement("center",null,s.a.createElement(g,{text:this.state.text,done:this.addTask,onChange:this.textChanged}))),o,s.a.createElement("div",{className:"body"},s.a.createElement(P,{items:i,distance:2,onSortEnd:this.onSortEnd})))}}]),t}(n.Component),I=(a(63),function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement(h.a,null,s.a.createElement(m.a,{exact:!0,path:"/",render:function(e){return s.a.createElement(F,null)}}))}}]),t}(n.Component)),z=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function L(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}i.a.render(s.a.createElement(I,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/jhg",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/jhg","/service-worker.js");z?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):L(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):L(t,e)})}}()}},[[30,2,1]]]);
//# sourceMappingURL=main.b65f02d1.chunk.js.map