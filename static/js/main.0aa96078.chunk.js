(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(t,e,n){t.exports=n.p+"static/media/play.0c1ce2dd.svg"},24:function(t,e,n){t.exports=n.p+"static/media/check_blank.5e8e3bc4.svg"},25:function(t,e,n){t.exports=n.p+"static/media/check_full.07199ac9.svg"},26:function(t,e,n){t.exports=n.p+"static/media/pause.586f15b3.svg"},27:function(t,e,n){t.exports=n.p+"static/media/plus.4b3f33aa.svg"},29:function(t,e,n){t.exports=n(65)},35:function(t,e,n){},62:function(t,e,n){},65:function(t,e,n){"use strict";n.r(e);var a=n(0),s=n.n(a),r=n(12),i=n.n(r),o=(n(35),n(4)),c=n(5),l=n(7),u=n(6),d=n(8),h=n(67),m=n(68),p=n(1),g=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(l.a)(this,Object(u.a)(e).call(this,t))).handleChange=n.handleChange.bind(Object(p.a)(Object(p.a)(n))),n.keypress=n.keypress.bind(Object(p.a)(Object(p.a)(n))),n}return Object(d.a)(e,t),Object(c.a)(e,[{key:"handleChange",value:function(t){this.props.onChange(t.target.value)}},{key:"keypress",value:function(t){"Enter"===t.key&&this.props.done()}},{key:"render",value:function(){var t=this.props.text;return s.a.createElement("input",{ref:"mainInput",className:"inputTask",type:"text",onChange:this.handleChange,value:t,onKeyPress:this.keypress})}}]),e}(a.Component),f=n(15),b=n.n(f),k=n(24),v=n.n(k),j=n(25),O=n.n(j),y=n(26),C=n.n(y),w=function(t){function e(){return Object(o.a)(this,e),Object(l.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){var t=this.props.started,e=this.props.done;return s.a.createElement("div",{className:"oneTask"},s.a.createElement("img",{className:"leftButton",src:t?C.a:b.a,alt:t?"Pause":"Start",onClick:this.props.onStart}),e?s.a.createElement("span",null,s.a.createElement("s",null," ",this.props.name," ")):s.a.createElement("span",null,this.props.name),s.a.createElement("img",{className:"rightButton",src:e?O.a:v.a,alt:e?"Mark not done":"Mark done",onClick:this.props.onComplete}))}}]),e}(a.Component),E=function(t){function e(){return Object(o.a)(this,e),Object(l.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return s.a.createElement("div",{className:"oneTask"},s.a.createElement("span",{onClick:this.props.onClick},this.props.name))}}]),e}(a.Component),T=function(t){function e(){return Object(o.a)(this,e),Object(l.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return s.a.createElement("div",{className:"oneTask"},s.a.createElement("span",{onClick:this.props.onClick},this.props.name))}}]),e}(a.Component),x=function(t){function e(){return Object(o.a)(this,e),Object(l.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return s.a.createElement("div",{className:"addFriend"},s.a.createElement("span",{onClick:this.props.onDone},"Not Ready"))}}]),e}(a.Component),S=n(16),_=n(13),N=n.n(_),A=n(27),W=n.n(A),D=Object(S.SortableElement)(function(t){var e=t.value;return s.a.createElement("li",null,e)}),I=Object(S.SortableContainer)(function(t){var e=t.items;return s.a.createElement("ul",null,e.map(function(t,e){return s.a.createElement(D,{key:"item-".concat(e),index:e,value:t})}))}),M=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(l.a)(this,Object(u.a)(e).call(this,t))).onSortEnd=function(t){var e=t.oldIndex,a=t.newIndex;n.setState({tasks:Object(S.arrayMove)(n.state.tasks,e,a)})},n.state={showing:"tasks",current_tag:"",possible_tags:[],guesses:[],tasks:[],friends:[],latest_type:"tag",new_task:{name:"",started:!1,times:[],done:[],tags:[{name:"",order:0}],aim_date:"",due_date:"",users:[]},text:"",user:{name:"Ilya",id:"0"}},n.getTasks=n.getTasks.bind(Object(p.a)(Object(p.a)(n))),n.getTags=n.getTags.bind(Object(p.a)(Object(p.a)(n))),n.processText=n.processText.bind(Object(p.a)(Object(p.a)(n))),n.commitAndClear=n.commitAndClear.bind(Object(p.a)(Object(p.a)(n))),n.commitTask=n.commitTask.bind(Object(p.a)(Object(p.a)(n))),n.textChanged=n.textChanged.bind(Object(p.a)(Object(p.a)(n))),n.complete=n.complete.bind(Object(p.a)(Object(p.a)(n))),n.start=n.start.bind(Object(p.a)(Object(p.a)(n))),n.onSortEnd=n.onSortEnd.bind(Object(p.a)(Object(p.a)(n))),n.addTask=n.addTask.bind(Object(p.a)(Object(p.a)(n))),n.show=n.show.bind(Object(p.a)(Object(p.a)(n))),n.sync=n.sync.bind(Object(p.a)(Object(p.a)(n))),n.reorder=n.reorder.bind(Object(p.a)(Object(p.a)(n))),n.componentDidMount=n.componentDidMount.bind(Object(p.a)(Object(p.a)(n))),n}return Object(d.a)(e,t),Object(c.a)(e,[{key:"show",value:function(t){this.setState({showing:t})}},{key:"componentDidMount",value:function(){this.getTasks(),this.getTags()}},{key:"sync",value:function(){this.reorder(),this.getTasks(),this.getTags()}},{key:"getTasks",value:function(){var t=this,e=this.state.current_tag;N.a.get("https://api.ibreznik.com/now",{params:{tag:e}}).then(function(t){return t.data}).then(function(n){n.sort(function(t,n){return t.tags.find(function(t){return t.name===e}).order-n.tags.find(function(t){return t.name===e}).order}).reverse(),t.setState({tasks:n})})}},{key:"componentWillUnmount",value:function(){this.reorder()}},{key:"reorder",value:function(){for(var t=this,e=this.state.tasks.slice(),n=e.length,a=0;a<n;a++)e[a].tags.find(function(e){return e.name===t.state.current_tag}).order=n-a,this.update(e[a])}},{key:"update",value:function(t){N.a.put("https://api.ibreznik.com/task",t)}},{key:"getTags",value:function(){var t=this;N.a.get("https://api.ibreznik.com/tags").then(function(e){return t.setState({possible_tags:e.data})})}},{key:"addFriend",value:function(t){}},{key:"processText",value:function(){for(var t=this.state.text,e=t.split(" ").filter(function(t){return t.startsWith("#")}),n=[],a=0;a<e.length;a++)t=t.replace(e[a],""),e[a]=e[a].replace("#","").toLowerCase(),n.push({name:e[a],order:0});n.push({name:"",order:0}),console.log(n),t=t.trim(),this.setState({text:t});var s=t.split(" ").filter(function(t){return t.startsWith("~")});if(s.length>0){t=t.replace(s[0],"");var r=s[0].substring(1).split("-");if(2===r.length)return{text:t,tags:n,est_low:r[0],est_high:r[1]};if(1===r.length)return{text:t,tags:n,est_low:r[0]}}return{text:t,tags:n}}},{key:"commitAndClear",value:function(t){this.commitTask(t),this.setState({text:""})}},{key:"commitTask",value:function(t){var e=this;console.log(t),N.a.post("https://api.ibreznik.com/task",t).then(function(t){var n=e.state.tasks,a=n.findIndex(function(t){return void 0===t._id});n[a]._id={$oid:t.data},e.setState({tasks:n})})}},{key:"addTask",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=t?[(new Date).getTime()]:[],n=this.processText(),a={name:n.text,tags:n.tags,times:e,started:t,done:!1};"est_high"in n&&(a.est_high=parseFloat(n.est_high)),"est_low"in n&&(a.est_low=parseFloat(n.est_low));var s=this.state.tasks;s.push(a),this.setState({tasks:s}),this.commitAndClear(a)}},{key:"textChanged",value:function(t){this.setState({text:t})}},{key:"createTag",value:function(t){}},{key:"setCurrentPerson",value:function(t){}},{key:"setCurrentTag",value:function(t){var e=this;this.setState({current_tag:t},function(){e.getTasks(),e.setState({showing:"tasks"})}),console.log(this.state.tasks)}},{key:"addTagToCurrent",value:function(t){}},{key:"complete",value:function(t){var e=this.state.tasks.slice();e[t].done=!e[t].done,e[t].started&&(e[t].started=!e[t].started,e[t].times.push((new Date).getTime())),this.setState({tasks:e}),this.update(e[t])}},{key:"start",value:function(t){var e=this.state.tasks.slice();e[t].started=!e[t].started,e[t].times.push((new Date).getTime()),e[t].done&&(e[t].done=!1),this.setState({tasks:e}),this.update(e[t])}},{key:"getLatestTag",value:function(){}},{key:"render",value:function(){var t=this,e=this.state.showing,n=this.state.latest_type,a=this.getLatestTag(),r="";"tasks"===e?r=this.state.tasks.map(function(e,n){return s.a.createElement(w,{name:e.name,id:e._id,started:e.started,done:e.done,onStart:function(){return t.start(n)},onComplete:function(){return t.complete(n)}})}):"guess"===e?r=this.state.possible_tags.map(function(e,n){return s.a.createElement(T,{name:e,onClick:function(){return t.addTagToCurrent(n)}})}):"tags"===e&&(console.log(this.state.possible_tags),"tag"===n?r=this.state.possible_tags.map(function(e,n){return s.a.createElement(T,{name:e,onClick:function(){return t.setCurrentTag(e)}})}):"user"===n&&(r=this.state.friends.map(function(e,n){return s.a.createElement(E,{name:e,onClick:function(){return t.setCurrentPerson(n)}})})));var i="";return"guess"===e?"tag"===n?i=s.a.createElement("div",{className:"createNewTag",onClick:function(){return t.createTag(a)}},'"Create new tag "+tag'):"user"===n&&(i=s.a.createElement(x,{onDone:this.addFriend})):i=s.a.createElement("div",{className:"controls"},s.a.createElement("div",{className:"rightControl"},"Edit"),s.a.createElement("div",{className:"leftControl",onClick:this.sync},"Sync"),s.a.createElement("center",null,"tasks"===e?s.a.createElement("div",{className:"centerControl",onClick:function(){return t.show("tags")}}," Switch to ..."):s.a.createElement("div",{className:"centerControl",onClick:function(){return t.setCurrentTag("")}}," Show all"))),s.a.createElement("div",{className:"main"},s.a.createElement("div",{className:"top"},s.a.createElement("img",{className:"add",src:W.a,alt:"Add",height:"35",onClick:function(){return t.addTask(!1)}}),s.a.createElement("img",{className:"addAndStart",src:b.a,alt:"Start",height:"35",onClick:function(){return t.addTask(!0)}}),s.a.createElement("center",null,s.a.createElement(g,{text:this.state.text,done:this.addTask,onChange:this.textChanged}))),i,s.a.createElement("div",{className:"body"},s.a.createElement(I,{items:r,distance:2,onSortEnd:this.onSortEnd})))}}]),e}(a.Component),P=(n(62),function(t){function e(){return Object(o.a)(this,e),Object(l.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return s.a.createElement(h.a,null,s.a.createElement(m.a,{exact:!0,path:"/",render:function(t){return s.a.createElement(M,null)}}))}}]),e}(a.Component)),F=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function L(t,e){navigator.serviceWorker.register(t).then(function(t){t.onupdatefound=function(){var n=t.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),e&&e.onUpdate&&e.onUpdate(t)):(console.log("Content is cached for offline use."),e&&e.onSuccess&&e.onSuccess(t)))})}}).catch(function(t){console.error("Error during service worker registration:",t)})}i.a.render(s.a.createElement(P,null),document.getElementById("root")),function(t){if("serviceWorker"in navigator){if(new URL("/jhg",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/jhg","/service-worker.js");F?(function(t,e){fetch(t).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(t){t.unregister().then(function(){window.location.reload()})}):L(t,e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e,t),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):L(e,t)})}}()}},[[29,2,1]]]);
//# sourceMappingURL=main.0aa96078.chunk.js.map